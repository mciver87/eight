<!DoCTYPE html>
<html>
<head>
  <meta charset=utf-8>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>intro Screen</title>
  <!--<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Raleway" />-->
  <link rel="stylesheet" type="text/css" href="css/main.css" />
    <script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
  <script type="text/javascript">
  $(document).ready(function() {
    $.getScript("http://ncparks3d.s3-website-us-east-1.amazonaws.com/build/vrview.min.js");

    $(document).click(function() { 
      if(!$(this).hasClass('vr-active')) {
        $('.vr-active').removeClass('vr-active');
      // clicked element does not have the class
      }     
    });

    $('.vrview-load').click(function(){   
      var vrViewerTarget = $(this).attr('vrtarget');
      $('#' + vrViewerTarget).empty();
      $('#' + vrViewerTarget).hide();
      // empty any other active viewer divs
      $('.vrcontainer').empty();
      $('figure img').css({opacity: 1});

      var viewerParams = new Array;
      viewerParams.is_stereo = 'false';
      var embedType = $(this).attr('vrtype');
      if (embedType == 'video') {
        viewerParams.video = '/media/' + $(this).val();
        var loopIsSet = $(this).attr('loop');
        if (typeof loopIsSet !== 'undefined') {
          viewerParams.loop = 'true';
        }
      }
      else if (embedType == 'image') {
        viewerParams.image = '/media/' + $(this).val();
      }
      // Optionally load the audio, if it is set.
      var audioFile = $(this).attr('audio');
      var playAudio = false;
      if (typeof audioFile !== 'undefined') {
        // Verify that there's an encoding type too.
        var audioEncoding = $(this).attr('audioformat');
        if (typeof audioEncoding !== 'undefined') {

        }
        else {
          audioEncoding = 'audio/mp3';
        }
        playAudio = true;
        $('#audio #audio-source').attr('src', 'http://ncparks3d.s3-website-us-east-1.amazonaws.com/media/audio/' + audioFile);
        $('#audio #audio-source').attr('type', audioEncoding);
      }
      var vrView = new VRView.Player('#' + vrViewerTarget, viewerParams);
      vrView.on('ready', function() {
        $('button').removeClass('vr-active');

        // pretty stuff
        $('#' + vrViewerTarget).parent().closest('img').fadeTo("slow", 0);
        $('#' + vrViewerTarget).addClass('vr-active');
        
        // end pretty stuff

        $('#' + vrViewerTarget).fadeIn("slow");
        // optional audio parameter play
        if (playAudio == true) {
          // Also, mute the video if we have audio.
          if (embedType == 'video') {
            vrView.setVolume(0);
          }
          $('#audio')[0].load();
          $('#audio')[0].play();
        }
        else {
          $('#audio')[0].load();
          $('#audio')[0].pause();
        }
      })
    });
  });
  </script>

  </style>
</head>
<body>

  <audio id="audio">
    <source id="audio-source"/>
  </audio>

  <div class="grid">
    <figure class="effect-apollo">
      <img src="images/raleigh.jpg" alt="img18" />
      <figcaption>
        <h2>Google <span>Fiber @ Glenwood</span></h2>
        <p>Coworking space in downtown Raleigh.</p>
        <button type="button" class="vrview-load" vrtarget="vrview" vrtype="video" loop value="newfly.mp4" audio="virtualinsanity.aac" audioformat="audio/aac" name="test">View more</button>
        <div class="vrcontainer"  id="vrview"></div>
      </figcaption>
    </figure>
    <figure class="effect-apollo-even">
      <img src="images/eclipse.jpg" alt="img22" />
      <figcaption>
        <h2>Solar <span>Eclipse</span></h2>
        <p>A rare alignment of elements.</p>
        <button type="button" class="vrview-load" vrtarget="vrview2" vrtype="image" value="eclipse.jpg" name="test">View more</button>
        <div class="vrcontainer"  id="vrview2"></div>
      </figcaption>
    </figure>
    <figure class="effect-apollo">
      <img src="images/millpond.jpg" alt="img18" />
      <figcaption>
        <h2>Merchants <span>Millpond</span></h2>
        <p>Southern swamp and hardwood forest.</p>
        <button type="button" class="vrview-load" vrtarget="vrview3" vrtype="image" value="converted.jpg" audio="lumberjack.aac" audioformat="audio/aac" name="test">View more</button>
        <div class="vrcontainer"  id="vrview3"></div>
      </figcaption>
    </figure>
  </div>



</body>
</html>